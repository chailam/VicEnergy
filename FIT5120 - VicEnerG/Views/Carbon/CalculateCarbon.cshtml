@model FIT5120___VicEnerG.ViewModels.CarbonViewModel

@{
    ViewBag.Title = "Carbon Calculator";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<div class="container body-content">
    <div class="container" id="carbon_info">
        <hr>
        <h3 class="heading">Carbon Footprint Calculator</h3>
    </div>

    <!-- Information input form-->
    <div class="row">

        <div class="Calculator-Content" id="carbon_info">
            <h3>What does the calculator do?</h3>
            <br>
            <div class="general">
                <p>
                    By inputting the postcode and the estimated number of solar panels installed in the Information Entry session,
                    the Carbon footprint calculator will calculate the estimated carbon emission of given kilowatt-hours of elecrticity.
                    Beside showing you the data, the calculator will show you how this data impacts your daily lives by showing the usage of few related components.
                    At the end of the page, you will see the CO2 reduction contribution of your estimated solar system to your selected postcode and to Victoria as well
                </p> <br>
                <ul>
                    <li><a href="~/Home/CarbonInfo">Click here for more information</a> about Carbon footprint/emission</li>
                    <li><a href="~/Calculator/CalculateOutput">Click here for more information</a> about the electricity output of your estimated solar system</li>
                </ul>
            </div>
        </div>
        <div class="Calculator-Content Input" id="carbon_info">
            <h3>Information Entry</h3>
            <br>
            @using (Html.BeginForm())
            {
                @Html.AntiForgeryToken()

                <div class="form-horizontal">

                    @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                    <div class="form-group">
                        <div class="col-md-6 text-center">
                            @Html.LabelFor(model => model.Postcode, htmlAttributes: new { @class = "control-label" })
                            @Html.TextBoxFor(model => model.Postcode, new { HtmlAttributes = new { @class = "form-control", @Value = Model.Postcode } })
                            @Html.ValidationMessageFor(model => model.Postcode, "", new { @class = "text-danger  col-md-12" })
                        </div>
                        <div class="col-md-6 text-center">
                            @Html.LabelFor(model => model.NumberPanels, "Number of Panels", htmlAttributes: new { @class = "control-label" })
                            @Html.TextBoxFor(model => model.NumberPanels, new { HtmlAttributes = new { @class = "form-control", @Value = Model.NumberPanels } })
                            @Html.ValidationMessageFor(model => model.NumberPanels, "", new { @class = "text-danger  col-md-12" })
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-md-offset-5 col-md-8">
                            <input type="submit" class="btn btn-primary" value="Calculate" />
                        </div>
                    </div>
                </div>
            }
        </div>
        <div class="Calculator-Content CarbonDescription" id="carbon_info">
            <h3>Carbon Dioxide Emissions</h3>
            <h4>The approxiamted Carbon Dioxide that will be saved in a year are:</h4>
            <div class="result-carbon">
                @Model.CO2 <p>metric tons CO2/kWh</p>
            </div>
            <p>*According to the department of Environment, Land and water of Australia. The co-efficient between electricity and CO2 is: </p>
            <p2>1kWh = 1.13kg CO2-e/kWh</p2>
        </div>

        <div class="Calculator-Content CarbonDailyLives" id="carbon_info">
            <h3>What does it mean?</h3> <br>
            <div class="row">
                <div class="col-xs-2 Component">
                    <span class="dot"></span>
                    <div class="content">
                        <p>The average carbon emissions intensity for passenger cars and light SUVs was 149.5 g/km.</p>
                    </div>
                    <img src="~/images/carbonIcon/Light.png" class="icon" />
                    <p2>@Model.LightVehicle km</p2>
                    <p3>of passenger vehicles driven.</p3>
                </div>
                <div class="col-xs-2 Component">
                    <span class="dot"></span>
                    <div class="content">
                        <p>The average carbon emissions intensity of heavy SUVs and light commercial vehicles was 216.7 g/km</p>
                    </div>
                    <img src="~/images/carbonIcon/Heavy.png" class="icon" />
                    <p2>@Model.HeavyVehicle km</p2>
                    <p3>of heavy vehicles driven.</p3>
                </div>
                <div class="col-xs-2 Component">
                    <span class="dot"></span>
                    <div class="content">
                        <p>The average carbon emissions of gasoline consumed was 8,887 g/gallon</p>
                    </div>
                    <img src="~/images/carbonIcon/Gasoline.png" class="icon" />
                    <p2>@Model.Gasoline gallons</p2>
                    <p3>of gasoline consumed.</p3>
                </div>
                <div class="col-xs-2 Component">
                    <span class="dot"></span>
                    <div class="content">
                        <p>The average carbon emissions of a mobile was 16.7kg/year through usage and charging</p>
                    </div>
                    <img src="~/images/carbonIcon/Phone_Charge.png" class="icon">
                    <p2>@Model.PhoneCharges times</p2>
                    <p3>of fully charged smartphones.</p3>
                </div>
                <div class="col-xs-2 Component">
                    <span class="dot"></span>
                    <div class="content">
                        <p>There are more than 70,000 trees in the city of Melbourne and each tree can absorb 2.49g/hour of carbon dioxide</p>
                    </div>
                    <img src="~/images/carbonIcon/Trees.png" class="icon" />
                    <p2>@Model.AbsorbHours hours</p2>
                    <p3>for Trees in the City of Melbourne to absorbs.</p3>
                </div>
            </div>

        </div>

        <div class="Calculator-Content Contribution" id="carbon_info">
            <h3>Annual Contribution</h3> <br>
            <div class="Calculator-Content Charts">
                <div class="row">
                    <div class="col-md-6">
                        <div class="panel-body">
                            <canvas id="Pie_suburb" height="150"></canvas>
                            @{ if (Model.SuburbTotalCO2 == 0)
                                {
                                    <p>Sorry, There is no solar output records in the given postcode</p>
                                }
                            }
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="panel-body">
                            <canvas id="Pie_state" height="150"></canvas>
                            <p>This is the average monthly solar output of Victoria</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section scripts{
    @Scripts.Render("~/bundles/chartjs")
    @Scripts.Render("~/bundles/chartjsLabel")
    <script>
        $(document).ready(function () {

            function chartinitialize() {
                // Display the pie chart by the element ID
                var Pie_suburb_display = $("#Pie_suburb");
                var Pie_state_display = $("#Pie_state");
                // Initial pie feature
                Pie_suburb = new Chart(Pie_suburb_display, {
                    type: 'pie',
                    data: {
                        labels: ["You", "Your Postcode"],
                        datasets: []
                    },
                    options: {
                        responsive: true,
                        title: {
                            display: true,
                            text: "Compare with your Postcode",
                            fontSize: 18
                        },
                        tooltips: {
                            enabled: true
                        },
                        plugins: {
                            labels: {
                                render: 'percentage',
                                fontColor: 'black',
                                precision: 2
                            }
                        }
                    }
                });
                // Initial pie feature
                Pie_state = new Chart(Pie_state_display, {
                    type: 'pie',
                    data: {
                        labels: ["You", "Victoria"],
                        datasets: []
                    },
                    options: {
                        responsive:true,
                        title: {
                            display: true,
                            text: "Compare with Victoria",
                            fontSize: 18
                        },
                        tooltips: {
                            enabled: true
                        },
                        plugins: {
                            labels: {
                                render: 'percentage',
                                fontColor: 'black',
                                precision: 2
                            }
                        },
                    }
                });
            };

            function InputData() {
            var SuburbTotalCO2 = @Html.Raw(Json.Encode(Model.SuburbTotalCO2));
            var VictoriaTotalCO2 = @Html.Raw(Json.Encode(Model.StateMonthlyCO2));
            var YourCO2 = @Html.Raw(Json.Encode(Model.CO2));
            var suburbDataSet = {
                data: [YourCO2, SuburbTotalCO2],
                labels: ["You", "Your Suburb"],
                backgroundColor: ["rgba(127,255,0,.5)", "rgb(255, 99, 132)"],
                hoverOffset: 4
            };
            var stateDataSet = {
                data: [YourCO2, VictoriaTotalCO2],
                labels: ["You", "Victoria"],
                backgroundColor: ["rgba(127,255,0,.5)", "rgb(255, 99, 132)"],
                hoverOffset: 4
            };
            Pie_suburb.data.datasets.push(suburbDataSet);
            Pie_state.data.datasets.push(stateDataSet);
            Pie_suburb.update();
            Pie_state.update();
            };


            chartinitialize();
            InputData();
        });
    </script>
}